# Road crash locations - Queensland 
Mario Fiamenghi  

###1.Introduction  
This dataset shows the position of vehicular crash incidents in Queensland. This includes fatalities, injuries and vehicular damage. The point of truth for this dataset is the Queensland government open data website at,https://data.qld.gov.au/dataset/crash-data-from-queensland-roads.

###2.Loading the  Dataset
- Create the variable time to report the system time to be used in the following line


```r
time<-Sys.time()
```
This code was last interpreted on *2014-10-31 23:44:48*  


-Download data from the following adress **[click to open QLD Data](https://data.qld.gov.au/dataset/crash-data-from-queensland-roads)**

- Using my own git hub repository, open directory from Git Hub repository created for this project:**[click to open github](https://github.com/fiamen/crash)**



- Reads file as a table to memory *crash location*

```r
loc=read.csv("../../data/locations (1).csv")
```
- Subset table

```r
loc1=loc[,c(2,3,19,30,31,32,33,39,44)]
```



###3.Analysis

####Did the number of fatality decrease since 2007?

#####1.Make a graph  of the total number of fatalities yearly




- The graphic can be generated by the code:

```r
suppressPackageStartupMessages(library(googleVis))
```

```
## Warning: package 'googleVis' was built under R version 3.0.3
```

```r
options(gvis.plot.tag="chart")
```


```r
loca=aggregate(loc1$Count_Casualty_Fatality,by= list(year=loc1$Crash_Year,region=loc1$Loc_Queensland_Transport_Region),sum,na=TRUE)
```

```r
M1 <- gvisMotionChart(loca, idvar="region", timevar="year")
plot(M1)
```

<!-- MotionChart generated in R 3.0.2 by googleVis 0.5.6 package -->
<!-- Fri Oct 31 23:44:49 2014 -->


<!-- jsHeader -->
<script type="text/javascript">
 
// jsData 
function gvisDataMotionChartID21ec40f52549 () {
var data = new google.visualization.DataTable();
var datajson =
[
 [
 "Central",
2001,
50 
],
[
 "Central",
2002,
49 
],
[
 "Central",
2003,
41 
],
[
 "Central",
2004,
42 
],
[
 "Central",
2005,
50 
],
[
 "Central",
2006,
52 
],
[
 "Central",
2007,
62 
],
[
 "Central",
2008,
35 
],
[
 "Central",
2009,
58 
],
[
 "Central",
2010,
43 
],
[
 "Central",
2011,
57 
],
[
 "Central",
2012,
51 
],
[
 "Central",
2013,
57 
],
[
 "Central",
2014,
6 
],
[
 "Northern",
2001,
48 
],
[
 "Northern",
2002,
47 
],
[
 "Northern",
2003,
38 
],
[
 "Northern",
2004,
30 
],
[
 "Northern",
2005,
55 
],
[
 "Northern",
2006,
58 
],
[
 "Northern",
2007,
42 
],
[
 "Northern",
2008,
63 
],
[
 "Northern",
2009,
60 
],
[
 "Northern",
2010,
41 
],
[
 "Northern",
2011,
30 
],
[
 "Northern",
2012,
44 
],
[
 "Northern",
2013,
34 
],
[
 "Northern",
2014,
12 
],
[
 "SEQ North",
2001,
68 
],
[
 "SEQ North",
2002,
69 
],
[
 "SEQ North",
2003,
76 
],
[
 "SEQ North",
2004,
57 
],
[
 "SEQ North",
2005,
57 
],
[
 "SEQ North",
2006,
70 
],
[
 "SEQ North",
2007,
67 
],
[
 "SEQ North",
2008,
64 
],
[
 "SEQ North",
2009,
67 
],
[
 "SEQ North",
2010,
43 
],
[
 "SEQ North",
2011,
43 
],
[
 "SEQ North",
2012,
58 
],
[
 "SEQ North",
2013,
56 
],
[
 "SEQ North",
2014,
5 
],
[
 "SEQ South",
2001,
94 
],
[
 "SEQ South",
2002,
94 
],
[
 "SEQ South",
2003,
91 
],
[
 "SEQ South",
2004,
109 
],
[
 "SEQ South",
2005,
95 
],
[
 "SEQ South",
2006,
94 
],
[
 "SEQ South",
2007,
124 
],
[
 "SEQ South",
2008,
91 
],
[
 "SEQ South",
2009,
78 
],
[
 "SEQ South",
2010,
70 
],
[
 "SEQ South",
2011,
82 
],
[
 "SEQ South",
2012,
72 
],
[
 "SEQ South",
2013,
67 
],
[
 "SEQ South",
2014,
13 
],
[
 "Southern",
2001,
69 
],
[
 "Southern",
2002,
68 
],
[
 "Southern",
2003,
69 
],
[
 "Southern",
2004,
78 
],
[
 "Southern",
2005,
78 
],
[
 "Southern",
2006,
66 
],
[
 "Southern",
2007,
70 
],
[
 "Southern",
2008,
80 
],
[
 "Southern",
2009,
73 
],
[
 "Southern",
2010,
57 
],
[
 "Southern",
2011,
62 
],
[
 "Southern",
2012,
60 
],
[
 "Southern",
2013,
62 
],
[
 "Southern",
2014,
21 
],
[
 "Unknown",
2001,
1 
],
[
 "Unknown",
2002,
1 
],
[
 "Unknown",
2003,
1 
],
[
 "Unknown",
2004,
1 
],
[
 "Unknown",
2005,
1 
],
[
 "Unknown",
2006,
1 
],
[
 "Unknown",
2007,
1 
],
[
 "Unknown",
2008,
1 
],
[
 "Unknown",
2009,
1 
],
[
 "Unknown",
2010,
1 
],
[
 "Unknown",
2011,
1 
],
[
 "Unknown",
2012,
1 
],
[
 "Unknown",
2013,
1 
] 
];
data.addColumn('string','region');
data.addColumn('number','year');
data.addColumn('number','x');
data.addRows(datajson);
return(data);
}
 
// jsDrawChart
function drawChartMotionChartID21ec40f52549() {
var data = gvisDataMotionChartID21ec40f52549();
var options = {};
options["width"] =    600;
options["height"] =    500;
options["state"] = "";

    var chart = new google.visualization.MotionChart(
    document.getElementById('MotionChartID21ec40f52549')
    );
    chart.draw(data,options);
    

}
  
 
// jsDisplayChart
(function() {
var pkgs = window.__gvisPackages = window.__gvisPackages || [];
var callbacks = window.__gvisCallbacks = window.__gvisCallbacks || [];
var chartid = "motionchart";
  
// Manually see if chartid is in pkgs (not all browsers support Array.indexOf)
var i, newPackage = true;
for (i = 0; newPackage && i < pkgs.length; i++) {
if (pkgs[i] === chartid)
newPackage = false;
}
if (newPackage)
  pkgs.push(chartid);
  
// Add the drawChart function to the global list of callbacks
callbacks.push(drawChartMotionChartID21ec40f52549);
})();
function displayChartMotionChartID21ec40f52549() {
  var pkgs = window.__gvisPackages = window.__gvisPackages || [];
  var callbacks = window.__gvisCallbacks = window.__gvisCallbacks || [];
  window.clearTimeout(window.__gvisLoad);
  // The timeout is set to 100 because otherwise the container div we are
  // targeting might not be part of the document yet
  window.__gvisLoad = setTimeout(function() {
  var pkgCount = pkgs.length;
  google.load("visualization", "1", { packages:pkgs, callback: function() {
  if (pkgCount != pkgs.length) {
  // Race condition where another setTimeout call snuck in after us; if
  // that call added a package, we must not shift its callback
  return;
}
while (callbacks.length > 0)
callbacks.shift()();
} });
}, 100);
}
 
// jsFooter
</script>
 
<!-- jsChart -->  
<script type="text/javascript" src="https://www.google.com/jsapi?callback=displayChartMotionChartID21ec40f52549"></script>
 
<!-- divChart -->
  
<div id="MotionChartID21ec40f52549" 
  style="width: 600; height: 500;">
</div>

```r
loca=aggregate(loc1$Count_Casualty_Fatality,by= list(year=loc1$Crash_Year,speed=loc1$Crash_Speed_Limit),sum,na=TRUE)
```

```r
M2 <- gvisMotionChart(loca, idvar="speed", timevar="year")
plot(M2)
```

<!-- MotionChart generated in R 3.0.2 by googleVis 0.5.6 package -->
<!-- Fri Oct 31 23:44:50 2014 -->


<!-- jsHeader -->
<script type="text/javascript">
 
// jsData 
function gvisDataMotionChartID21ec2d99455a () {
var data = new google.visualization.DataTable();
var datajson =
[
 [
 "0 - 50 km/h",
2001,
17 
],
[
 "0 - 50 km/h",
2002,
10 
],
[
 "0 - 50 km/h",
2003,
23 
],
[
 "0 - 50 km/h",
2004,
29 
],
[
 "0 - 50 km/h",
2005,
24 
],
[
 "0 - 50 km/h",
2006,
36 
],
[
 "0 - 50 km/h",
2007,
37 
],
[
 "0 - 50 km/h",
2008,
24 
],
[
 "0 - 50 km/h",
2009,
38 
],
[
 "0 - 50 km/h",
2010,
23 
],
[
 "0 - 50 km/h",
2011,
22 
],
[
 "0 - 50 km/h",
2012,
21 
],
[
 "0 - 50 km/h",
2013,
23 
],
[
 "0 - 50 km/h",
2014,
7 
],
[
 "100 - 110 km/h",
2001,
167 
],
[
 "100 - 110 km/h",
2002,
165 
],
[
 "100 - 110 km/h",
2003,
137 
],
[
 "100 - 110 km/h",
2004,
140 
],
[
 "100 - 110 km/h",
2005,
178 
],
[
 "100 - 110 km/h",
2006,
144 
],
[
 "100 - 110 km/h",
2007,
163 
],
[
 "100 - 110 km/h",
2008,
149 
],
[
 "100 - 110 km/h",
2009,
142 
],
[
 "100 - 110 km/h",
2010,
122 
],
[
 "100 - 110 km/h",
2011,
143 
],
[
 "100 - 110 km/h",
2012,
123 
],
[
 "100 - 110 km/h",
2013,
137 
],
[
 "100 - 110 km/h",
2014,
27 
],
[
 "60 km/h",
2001,
91 
],
[
 "60 km/h",
2002,
84 
],
[
 "60 km/h",
2003,
79 
],
[
 "60 km/h",
2004,
93 
],
[
 "60 km/h",
2005,
75 
],
[
 "60 km/h",
2006,
99 
],
[
 "60 km/h",
2007,
83 
],
[
 "60 km/h",
2008,
95 
],
[
 "60 km/h",
2009,
75 
],
[
 "60 km/h",
2010,
55 
],
[
 "60 km/h",
2011,
60 
],
[
 "60 km/h",
2012,
78 
],
[
 "60 km/h",
2013,
53 
],
[
 "60 km/h",
2014,
14 
],
[
 "70 km/h",
2001,
15 
],
[
 "70 km/h",
2002,
19 
],
[
 "70 km/h",
2003,
13 
],
[
 "70 km/h",
2004,
14 
],
[
 "70 km/h",
2005,
18 
],
[
 "70 km/h",
2006,
16 
],
[
 "70 km/h",
2007,
19 
],
[
 "70 km/h",
2008,
14 
],
[
 "70 km/h",
2009,
15 
],
[
 "70 km/h",
2010,
13 
],
[
 "70 km/h",
2011,
6 
],
[
 "70 km/h",
2012,
13 
],
[
 "70 km/h",
2013,
12 
],
[
 "80 - 90 km/h",
2001,
39 
],
[
 "80 - 90 km/h",
2002,
49 
],
[
 "80 - 90 km/h",
2003,
63 
],
[
 "80 - 90 km/h",
2004,
40 
],
[
 "80 - 90 km/h",
2005,
40 
],
[
 "80 - 90 km/h",
2006,
45 
],
[
 "80 - 90 km/h",
2007,
63 
],
[
 "80 - 90 km/h",
2008,
51 
],
[
 "80 - 90 km/h",
2009,
66 
],
[
 "80 - 90 km/h",
2010,
41 
],
[
 "80 - 90 km/h",
2011,
43 
],
[
 "80 - 90 km/h",
2012,
50 
],
[
 "80 - 90 km/h",
2013,
51 
],
[
 "80 - 90 km/h",
2014,
8 
] 
];
data.addColumn('string','speed');
data.addColumn('number','year');
data.addColumn('number','x');
data.addRows(datajson);
return(data);
}
 
// jsDrawChart
function drawChartMotionChartID21ec2d99455a() {
var data = gvisDataMotionChartID21ec2d99455a();
var options = {};
options["width"] =    600;
options["height"] =    500;
options["state"] = "";

    var chart = new google.visualization.MotionChart(
    document.getElementById('MotionChartID21ec2d99455a')
    );
    chart.draw(data,options);
    

}
  
 
// jsDisplayChart
(function() {
var pkgs = window.__gvisPackages = window.__gvisPackages || [];
var callbacks = window.__gvisCallbacks = window.__gvisCallbacks || [];
var chartid = "motionchart";
  
// Manually see if chartid is in pkgs (not all browsers support Array.indexOf)
var i, newPackage = true;
for (i = 0; newPackage && i < pkgs.length; i++) {
if (pkgs[i] === chartid)
newPackage = false;
}
if (newPackage)
  pkgs.push(chartid);
  
// Add the drawChart function to the global list of callbacks
callbacks.push(drawChartMotionChartID21ec2d99455a);
})();
function displayChartMotionChartID21ec2d99455a() {
  var pkgs = window.__gvisPackages = window.__gvisPackages || [];
  var callbacks = window.__gvisCallbacks = window.__gvisCallbacks || [];
  window.clearTimeout(window.__gvisLoad);
  // The timeout is set to 100 because otherwise the container div we are
  // targeting might not be part of the document yet
  window.__gvisLoad = setTimeout(function() {
  var pkgCount = pkgs.length;
  google.load("visualization", "1", { packages:pkgs, callback: function() {
  if (pkgCount != pkgs.length) {
  // Race condition where another setTimeout call snuck in after us; if
  // that call added a package, we must not shift its callback
  return;
}
while (callbacks.length > 0)
callbacks.shift()();
} });
}, 100);
}
 
// jsFooter
</script>
 
<!-- jsChart -->  
<script type="text/javascript" src="https://www.google.com/jsapi?callback=displayChartMotionChartID21ec2d99455a"></script>
 
<!-- divChart -->
  
<div id="MotionChartID21ec2d99455a" 
  style="width: 600; height: 500;">
</div>

-Subset table for fatalities and vreates variable with latitude and Longitude

```r
loc2=loc[,c(3,4,39,9,10)]
```
-Aggregate fatalities by coordinates

```r
loc2$Crash_Longitude_GDA94_1=round(loc2$Crash_Longitude_GDA94,2)
loc2$Crash_Latitude_GDA94_1=round(loc2$Crash_Latitude_GDA94,2)
loc2$latlong<-paste(loc2$Crash_Latitude_GDA94_1, loc2$Crash_Longitude_GDA94_1, sep=":")
loc3=aggregate(loc2$Count_Casualty_Fatality,by=list(coordinate=loc2$Count_Casualty_Fatality),sum,na=TRUE)
```


-Create a Geo graphic with fatality crashs

```r
M3= gvisGeoChart(loc3, "x",
                   options=list(displayMode="Markers", region="009",
                   colorAxis="{colors:['red', 'grey']}",
                   backgroundColor="lightblue"))
plot(M3)
```

<!-- GeoChart generated in R 3.0.2 by googleVis 0.5.6 package -->
<!-- Fri Oct 31 23:44:50 2014 -->


<!-- jsHeader -->
<script type="text/javascript">
 
// jsData 
function gvisDataGeoChartID21ec590c6181 () {
var data = new google.visualization.DataTable();
var datajson =
[
 [
 "1" 
],
[
 "3410" 
],
[
 "479" 
],
[
 "112" 
],
[
 "45" 
],
[
 "31" 
] 
];
data.addColumn('string','x');
data.addRows(datajson);
return(data);
}
 
// jsDrawChart
function drawChartGeoChartID21ec590c6181() {
var data = gvisDataGeoChartID21ec590c6181();
var options = {};
options["width"] =    556;
options["height"] =    347;
options["displayMode"] = "Markers";
options["region"] = "009";
options["colorAxis"] = {colors:['red', 'grey']};
options["backgroundColor"] = "lightblue";

    var chart = new google.visualization.GeoChart(
    document.getElementById('GeoChartID21ec590c6181')
    );
    chart.draw(data,options);
    

}
  
 
// jsDisplayChart
(function() {
var pkgs = window.__gvisPackages = window.__gvisPackages || [];
var callbacks = window.__gvisCallbacks = window.__gvisCallbacks || [];
var chartid = "geochart";
  
// Manually see if chartid is in pkgs (not all browsers support Array.indexOf)
var i, newPackage = true;
for (i = 0; newPackage && i < pkgs.length; i++) {
if (pkgs[i] === chartid)
newPackage = false;
}
if (newPackage)
  pkgs.push(chartid);
  
// Add the drawChart function to the global list of callbacks
callbacks.push(drawChartGeoChartID21ec590c6181);
})();
function displayChartGeoChartID21ec590c6181() {
  var pkgs = window.__gvisPackages = window.__gvisPackages || [];
  var callbacks = window.__gvisCallbacks = window.__gvisCallbacks || [];
  window.clearTimeout(window.__gvisLoad);
  // The timeout is set to 100 because otherwise the container div we are
  // targeting might not be part of the document yet
  window.__gvisLoad = setTimeout(function() {
  var pkgCount = pkgs.length;
  google.load("visualization", "1", { packages:pkgs, callback: function() {
  if (pkgCount != pkgs.length) {
  // Race condition where another setTimeout call snuck in after us; if
  // that call added a package, we must not shift its callback
  return;
}
while (callbacks.length > 0)
callbacks.shift()();
} });
}, 100);
}
 
// jsFooter
</script>
 
<!-- jsChart -->  
<script type="text/javascript" src="https://www.google.com/jsapi?callback=displayChartGeoChartID21ec590c6181"></script>
 
<!-- divChart -->
  
<div id="GeoChartID21ec590c6181" 
  style="width: 556; height: 347;">
</div>

