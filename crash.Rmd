
---
title: 'Road crash locations - Queensland '
author: "Mario Fiamenghi"
output:
  html_document:
    fig_caption: yes
    keep_md: yes
---
###1.Introduction  
This dataset shows the position of vehicular crash incidents in Queensland. This includes fatalities, injuries and vehicular damage. The point of truth for this dataset is the Queensland government open data website at,https://data.qld.gov.au/dataset/crash-data-from-queensland-roads.

###2.Loading the  Dataset
- Create the variable time to report the system time to be used in the following line

```{r}
time<-Sys.time()
```
This code was last interpreted on *`r time`*  


-Download data from the following adress **[click to open QLD Data](https://data.qld.gov.au/dataset/crash-data-from-queensland-roads)**

- Using my own git hub repository, open directory from Git Hub repository created for this project:**[click to open github](https://github.com/fiamen/crash)**



- Reads file as a table to memory *crash location*
```{r,cache=TRUE}
loc=read.csv("../../data/locations (1).csv")
loc$latlon=paste0(loc$Crash_Latitude_GDA94,":",loc$Crash_Longitude_GDA94)
``` 
- Subset table
```{r,cache=TRUE}
loc1=loc[,c(2,3,19,30,31,32,33,39,44)]
```



###3.Analysis

####Did the number of fatality decrease since 2007?

#####1.Make a graph  of the total number of fatalities yearly




- The graphic can be generated by the code:
```{r graphic1,message=FALSE}
suppressPackageStartupMessages(library(googleVis))
options(gvis.plot.tag="chart")

   
```

```{r}
loca=aggregate(loc1$Count_Casualty_Fatality,by= list(year=loc1$Crash_Year,region=loc1$Loc_Queensland_Transport_Region),sum,na=TRUE)

```
```{r,results='asis'}

M1 <- gvisMotionChart(loca, idvar="region", timevar="year")
plot(M1)
```
```{r}
loca=aggregate(loc1$Count_Casualty_Fatality,by= list(year=loc1$Crash_Year,speed=loc1$Crash_Speed_Limit),sum,na=TRUE)

```
```{r,results='asis'}

M2 <- gvisMotionChart(loca, idvar="speed", timevar="year")
plot(M2)
```

-Subset table for fatalities and vreates variable with latitude and Longitude
```{r,cache=TRUE}
loc2=loc[,c(3,4,39,9,10)]

```
-Aggregate fatalities by coordinates
```{r,cache=TRUE}
loc2$Crash_Longitude_GDA94_1=round(loc2$Crash_Longitude_GDA94,2)
loc2$Crash_Latitude_GDA94_1=round(loc2$Crash_Latitude_GDA94,2)
loc2$latlong<-paste0(loc2$Crash_Latitude_GDA94_1, loc2$Crash_Longitude_GDA94_1, sep=":")
loc3=aggregate(loc2$Count_Casualty_Fatality,by=list(coordinate=loc2$latlong),sum,na=TRUE)
```


-Create a Geo graphic with fatality crashs
```{r,results='asis'}
G4 <- gvisGeoMap(loc[1:10,], locationvar="latlon", numvar="Count_Casualty_Total",
                 
                 options=list(height=350, region="AU",dataMode="markers",regionClick=TRUE))

plot(G4)
```
```{r,results='asis'}
G4 <- gvisMap(loc[1:100,], locationvar="latlon",options=list(mapType='normal')               
,chartid="2036")
 plot(G4)

```


