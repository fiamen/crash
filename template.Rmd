
---
title: 'Reproducible Research: Peer Assessment 1 '
author: "Mario Fiamenghi"
output:
  html_document:
    fig_caption: yes
    keep_md: yes
---
###1.Introduction  
This report details the procedures in order to answer questions to the peer assessment `project 1`.

###2.Loading the  Dataset
- Create the variable time to report the system time to be used in the following line

```{r}
time<-Sys.time()
```
This code was last interpreted on *`r time`*  

- Using your own git hub repository, fork the directory from Git Hub repository created for this assignment:**[click to fork](https://github.com/rdpeng/RepData_PeerAssessment1/fork)**


- Using git bash, set up track remote information to master branch using the command:`git branch --set-upstream-to=origin/master`  

- In git bash, pull the repo into the local directory using the command:`git pull`  


- Unzip and save file *activity.zip*
```{r, cache=TRUE}
unzip("activity.zip")
``` 
- Read the file into a table
```{r,cache=TRUE}
activity<-read.csv("activity.csv")
```

- Note: no data transformation for this part  

###3.Analysis

####What is mean total number of steps taken per day?

#####1.Make a histogram of the total number of steps taken each day

- The histogram of the steps per day can be generated by the code:
```{r histogram1}
stepsbyday=aggregate(activity$steps,by= list(date=activity$date),sum,na=TRUE)
names(stepsbyday)=c("Date","Steps")
with(stepsbyday,hist(Steps,col="red",main= "Distribution of Steps per Day"))
   
```

#####2.Calculate and report the mean and median total number of steps taken per day

- The mean and median of the steps variable can calculated ignoring `NA` values using the expression:  
```{r,cache=TRUE}
mean<-with(stepsbyday,mean(Steps,na.rm=TRUE))
median<-with(stepsbyday,median(Steps,na.rm=TRUE))

```

- The mean and median of steps for all days in the dataset are respectively **`r format(mean,big.mark=" ")`** and **`r format(median,big.mark=" ")`**


####What is the average daily activity pattern?
#####1.Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)
- Subset the original dataset to average by interval and then plot the times series using this code:

```{r timeseries1, warning=FALSE}
stepsbyinterval=aggregate(activity$steps,by= list(interval=activity$interval),mean,na=TRUE)
names(stepsbyinterval)=c("Interval","Steps")
library(ggplot2)
with(stepsbyinterval,qplot(Interval,Steps,geom="line",main= "Average Steps per Interval all Days"))
```

#####2.Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?
- Query the average interval subset for the interval with the maximum value of steps with the code:

```{r}
maximum=with(stepsbyinterval,Interval[which(Steps==max(Steps))])
```
The interval with the maximum number of steps on average is **`r maximum`**

####Imputing missing values
#####1.Calculate and report the total number of missing values in the dataset (i.e. the total number of rows with NAs)

- Total number or items with `NA`
```{r,cache=TRUE}
na<-sum(is.na(activity$steps))
```
The total number of records with `NA` in the steps field are: **`r na`**

- Filling in all of the missing values in the dataset and create a new dataset 

use mice package to impute missing values


```{r,cache=TRUE, results='hide', warning=FALSE}
library(mice)
set.seed(123)
imputed=complete(mice(activity))

```
- New histogram of the total number of steps taken each day
```{r histogram2}
stepsbydayI=aggregate(imputed$steps,by= list(date=imputed$date),sum,na=TRUE)
names(stepsbydayI)=c("Date","Steps")
with(stepsbydayI,hist(Steps,col="blue",main= "Distribution of Steps per Day Imputed"))
```

The new mean and median of the steps variable can calculated:  
```{r,cache=TRUE}
meanI<-with(stepsbydayI,mean(Steps))
medianI<-with(stepsbydayI,median(Steps))

```

- The `New` mean and median of steps for all days in the dataset are respectively **`r format(meanI,big.mark=" ")`** and **`r format(medianI,big.mark=" ")`**

**Both the mean and median have been increades after imput missing data**

####Are there differences in activity patterns between weekdays and weekends?

#####1.Create a new factor variable in the dataset with two levels -- "weekday" and "weekend" indicating whether a given date is a weekday or weekend day.

```{r, warning=FALSE}
library(timeDate)
imputed$weekday<-ifelse(isWeekday(as.Date(imputed$date)),"weekdays","weekends")
```
#####2.Make a panel plot containing a time series for weekdays and weekends

```{r timeseries2,warning=FALSE}
library(lattice)

stepsbyintervalII=aggregate(imputed$steps,by= list(interval=imputed$interval,weekday=imputed$weekday),mean)
names(stepsbyintervalII)=c("interval","weekday","steps")


xyplot(steps~interval|weekday,data=stepsbyintervalII,type="l",layout=c(1,2))

```


**Weekends and weekdays present different activity patterns.For weekends there are more pics of activities for different intervals.**